<h1>Add New User</h1>

<% if (typeof errors !== 'undefined' && errors.length > 0) { %>
  <div class="alert alert-danger">
    <ul>
      <% errors.forEach(error => { %>
        <li><%= error %></li>
      <% }) %>
    </ul>
  </div>
<% } %>

<form method="POST" action="/admin/users/add">
  <div class="form-group">
    <label for="name">Name</label>
    <input type="text" id="name" name="name" value="<%= typeof formData !== 'undefined' ? formData.name : '' %>" required>
  </div>

  <div class="form-group">
    <label for="email">Email</label>
    <input type="email" id="email" name="email" value="<%= typeof formData !== 'undefined' ? formData.email : '' %>" required>
  </div>

  <div class="form-group">
    <label for="role">Role</label>
    <select id="role" name="role" required>
      <option value="">Select Role</option>
      <option value="user" <%= typeof formData !== 'undefined' && formData.role === 'user' ? 'selected' : '' %>>User</option>
      <option value="admin" <%= typeof formData !== 'undefined' && formData.role === 'admin' ? 'selected' : '' %>>Admin</option>
    </select>
  </div>

  <div class="form-group">
    <label for="password">Password</label>
    <input type="password" id="password" name="password" required>
    <small>Password must be at least 6 characters long</small>
  </div>

  <div class="form-group">
    <label for="confirm_password">Confirm Password</label>
    <input type="password" id="confirm_password" name="confirm_password" required>
  </div>

  <div class="form-group">
    <button type="submit" class="btn">Create User</button>
    <a href="/admin/users" class="btn">Cancel</a>
  </div>
</form>

<link rel="stylesheet" href="/css/styles.css">

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('form');
    const passwordField = document.getElementById('password');
    const confirmPasswordField = document.getElementById('confirm_password');

    form.addEventListener('submit', function(e) {
      const password = passwordField.value;
      const confirmPassword = confirmPasswordField.value;

      if (password !== confirmPassword) {
        e.preventDefault();
        alert('Passwords do not match!');
        confirmPasswordField.focus();
        return false;
      }

      if (password.length < 6) {
        e.preventDefault();
        alert('Password must be at least 6 characters long!');
        passwordField.focus();
        return false;
      }
    });
  });
</script>
