<div class="min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4">
  <div class="max-w-3xl mx-auto bg-white dark:bg-gray-800 rounded-lg shadow p-8">
    <!-- Header -->
    <div class="flex items-center justify-between mb-8">
      <div>
        <h1 class="text-2xl font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2">
          <i class="fas fa-plus"></i> Add New PDA
        </h1>
        <p class="text-gray-600 dark:text-gray-300 mt-1">Create a new PDA record</p>
      </div>
      <a href="/pdas" class="inline-flex items-center px-4 py-2 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-100 rounded-md font-semibold transition">
        <i class="fas fa-arrow-left mr-2"></i> Back to PDAs
      </a>
    </div>

    <% if (locals.errors && errors.length > 0) { %>
      <div class="mb-6 bg-red-100 dark:bg-red-900 border border-red-300 dark:border-red-700 text-red-800 dark:text-red-200 rounded-lg p-4">
        <div class="flex items-center gap-2 mb-2">
          <i class="fas fa-exclamation-triangle"></i>
          <span class="font-semibold">Please fix the following errors:</span>
        </div>
        <ul class="list-disc pl-6 space-y-1">
          <% errors.forEach(error => { %>
            <li><%= error %></li>
          <% }); %>
        </ul>
      </div>
    <% } %>

    <form method="POST" action="/pdas" class="space-y-8" novalidate>
      <div>
        <h3 class="text-lg font-semibold text-gray-700 dark:text-gray-200 mb-4 flex items-center gap-2">
          <i class="fas fa-info-circle"></i> PDA Information
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label for="serial_number" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200 required">Serial Number</label>
            <input
              type="text"
              id="serial_number"
              name="serial_number"
              value="<%= locals.formData ? formData.serial_number : '' %>"
              placeholder="e.g., PDA001, SN123456"
              required
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
            >
            <div class="text-xs text-red-600 mt-1 hidden">Please provide a serial number.</div>
            <small class="text-gray-500 dark:text-gray-400">Unique serial number for the PDA device</small>
          </div>
          <div>
            <label for="model" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200">Model</label>
            <input
              type="text"
              id="model"
              name="model"
              value="<%= locals.formData ? formData.model : '' %>"
              placeholder="e.g., Zebra TC21"
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
            >
          </div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
          <div>
            <label for="client_id" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200 required">Client</label>
            <select
              id="client_id"
              name="client_id"
              required
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
            >
              <option value="">Select a client...</option>
              <% clients.forEach(client => { %>
                <option value="<%= client.id %>"
                  <%= (locals.formData && formData.client_id == client.id) || (req.query.client_id == client.id) ? 'selected' : '' %>>
                  <%= client.name %> (<%= client.client_id %>)
                </option>
              <% }); %>
            </select>
            <div class="text-xs text-red-600 mt-1 hidden">Please select a client.</div>
          </div>
          <div>
            <label for="status_id" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200 required">Status</label>
            <select
              id="status_id"
              name="status_id"
              required
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
            >
              <option value="">Select a status...</option>
              <% statuses.forEach(status => { %>
                <option value="<%= status.id %>"
                  <%= locals.formData && formData.status_id == status.id ? 'selected' : '' %>>
                  <%= status.name %>
                </option>
              <% }); %>
            </select>
            <div class="text-xs text-red-600 mt-1 hidden">Please select a status.</div>
          </div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
          <div>
            <label for="cost" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200">Cost (â‚¬)</label>
            <input
              type="number"
              step="0.01"
              id="cost"
              name="cost"
              value="<%= locals.formData ? formData.cost : '' %>"
              placeholder="e.g., 450.00"
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
            >
          </div>
        </div>
      </div>
      <div class="flex items-center gap-4 mt-8">
        <button type="submit" class="inline-flex items-center px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-md transition">
          <i class="fas fa-save mr-2"></i> Create PDA
        </button>
        <a href="/pdas" class="inline-flex items-center px-6 py-2 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-100 font-semibold rounded-md transition">
          <i class="fas fa-times mr-2"></i> Cancel
        </a>
      </div>
    </form>
  </div>
</div>

<script>
// Pre-select client if coming from client page
const urlParams = new URLSearchParams(window.location.search);
const clientId = urlParams.get('client_id');
if (clientId) {
  document.getElementById('client_id').value = clientId;
}
</script>
