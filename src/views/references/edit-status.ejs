<div class="mb-8">
  <h1 class="text-2xl font-bold text-gray-800 dark:text-gray-100">Edit Status</h1>
</div>

<% if (typeof errors !== 'undefined' && errors.length > 0) { %>
  <div class="mb-4 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 px-4 py-3 rounded">
    <ul class="list-disc pl-5">
      <% errors.forEach(error => { %>
        <li><%= error %></li>
      <% }) %>
    </ul>
  </div>
<% } %>

<div class="max-w-xl mx-auto bg-white dark:bg-gray-800 p-8 rounded-lg shadow-md">
  <form method="POST" action="/references/statuses/<%= status.id %>" class="space-y-6">
    <div>
      <label for="name" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200">Status Name</label>
      <input type="text" id="name" name="name" value="<%= status.name %>" required
        class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
      <small class="text-gray-500 dark:text-gray-400">Name of the status (e.g., Active, Inactive, Under Repair, Retired)</small>
    </div>

    <div>
      <label for="description" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200">Description</label>
      <textarea id="description" name="description" rows="3"
        class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"><%= status.description || '' %></textarea>
      <small class="text-gray-500 dark:text-gray-400">Optional description explaining what this status represents</small>
    </div>

    <div>
      <label for="icon" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200">Status Icon</label>
      <select id="icon" name="icon"
        class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
        <option value="fas fa-check-circle" <%= status.icon === 'fas fa-check-circle' ? 'selected' : '' %>>‚úì Active/Working</option>
        <option value="fas fa-wrench" <%= status.icon === 'fas fa-wrench' ? 'selected' : '' %>>üîß Maintenance/Repair</option>
        <option value="fas fa-archive" <%= status.icon === 'fas fa-archive' ? 'selected' : '' %>>üì¶ Retired/Archived</option>
        <option value="fas fa-times-circle" <%= status.icon === 'fas fa-times-circle' ? 'selected' : '' %>>‚ùå Lost/Missing</option>
        <option value="fas fa-box" <%= status.icon === 'fas fa-box' ? 'selected' : '' %>>üì¶ In Storage</option>
        <option value="fas fa-exclamation-triangle" <%= status.icon === 'fas fa-exclamation-triangle' ? 'selected' : '' %>>‚ö†Ô∏è Warning/Attention</option>
        <option value="fas fa-pause-circle" <%= status.icon === 'fas fa-pause-circle' ? 'selected' : '' %>>‚è∏Ô∏è Inactive/Paused</option>
        <option value="fas fa-shield-alt" <%= status.icon === 'fas fa-shield-alt' ? 'selected' : '' %>>üõ°Ô∏è Protected/Warranty</option>
        <option value="fas fa-clock" <%= status.icon === 'fas fa-clock' ? 'selected' : '' %>>‚è∞ Pending/Waiting</option>
        <option value="fas fa-tools" <%= status.icon === 'fas fa-tools' ? 'selected' : '' %>>üõ†Ô∏è Under Service</option>
        <option value="fas fa-fire" <%= status.icon === 'fas fa-fire' ? 'selected' : '' %>>üî• Critical/Urgent</option>
        <option value="fas fa-tag" <%= status.icon === 'fas fa-tag' ? 'selected' : '' %>>üè∑Ô∏è Generic/Other</option>
      </select>
      <small class="text-gray-500 dark:text-gray-400">Icon that represents this status visually</small>
      <!-- Icon Preview -->
      <div class="mt-2 p-2 bg-gray-100 dark:bg-gray-900 rounded">
        <span class="text-sm text-gray-600 dark:text-gray-400">Preview: </span>
        <i id="iconPreview" class="<%= status.icon || 'fas fa-tag' %> text-lg"></i>
        <span id="iconLabel" class="ml-2 text-sm"></span>
      </div>
    </div>

    <div>
      <label for="color" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200">Status Color</label>
      <select id="color" name="color"
        class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
        <option value="green" <%= status.color === 'green' ? 'selected' : '' %>>Green (Active/Good)</option>
        <option value="yellow" <%= status.color === 'yellow' ? 'selected' : '' %>>Yellow (Warning/Attention)</option>
        <option value="red" <%= status.color === 'red' ? 'selected' : '' %>>Red (Problem/Inactive)</option>
        <option value="blue" <%= status.color === 'blue' ? 'selected' : '' %>>Blue (Information)</option>
        <option value="gray" <%= status.color === 'gray' ? 'selected' : '' %>>Gray (Neutral)</option>
      </select>
      <small class="text-gray-500 dark:text-gray-400">Color coding for this status in reports and displays</small>
    </div>

    <div>
      <label class="flex items-center gap-2 cursor-pointer">
        <input type="checkbox" name="is_active" value="true" <%= status.is_active ? 'checked' : '' %>
          class="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
        <span class="font-semibold text-gray-700 dark:text-gray-200">Active Status</span>
      </label>
      <small class="text-gray-500 dark:text-gray-400">Whether items with this status are considered active/in-use</small>
    </div>

    <div class="flex items-center gap-4 mt-8">
      <button type="submit" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-md transition flex items-center gap-2">
        <i class="fas fa-save"></i> Update Status
      </button>
      <a href="/references/statuses" class="px-6 py-2 bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-100 font-semibold rounded-md transition flex items-center gap-2">
        <i class="fas fa-times"></i> Cancel
      </a>
    </div>
  </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const iconSelect = document.getElementById('icon');
  const iconPreview = document.getElementById('iconPreview');
  const iconLabel = document.getElementById('iconLabel');

  const iconLabels = {
    'fas fa-check-circle': 'Active/Working',
    'fas fa-wrench': 'Maintenance/Repair',
    'fas fa-archive': 'Retired/Archived',
    'fas fa-times-circle': 'Lost/Missing',
    'fas fa-box': 'In Storage',
    'fas fa-exclamation-triangle': 'Warning/Attention',
    'fas fa-pause-circle': 'Inactive/Paused',
    'fas fa-shield-alt': 'Protected/Warranty',
    'fas fa-clock': 'Pending/Waiting',
    'fas fa-tools': 'Under Service',
    'fas fa-fire': 'Critical/Urgent',
    'fas fa-tag': 'Generic/Other'
  };

  function updateIconPreview() {
    const selectedIcon = iconSelect.value;
    iconPreview.className = selectedIcon + ' text-lg';
    iconLabel.textContent = iconLabels[selectedIcon] || 'Unknown';
  }

  iconSelect.addEventListener('change', updateIconPreview);

  // Set initial preview
  updateIconPreview();
});
</script>

