<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Asset Assignment Report - <%= employee.name %></title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      color: #1f2937;
      line-height: 1.5;
      background: #ffffff;
    }

    .report-container {
      max-width: 210mm;
      margin: 0 auto;
      background: white;
      min-height: 297mm;
    }

    /* Header Section */
    .header {
      background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
      color: white;
      padding: 2rem 2.5rem;
      position: relative;
      overflow: hidden;
    }

    .header::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 200px;
      height: 100%;
      background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 100%);
    }

    .header-content {
      position: relative;
      z-index: 1;
    }

    .company-logo {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }

    .logo-icon {
      width: 48px;
      height: 48px;
      background: rgba(255,255,255,0.2);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .company-name {
      font-size: 1.5rem;
      font-weight: 700;
      letter-spacing: -0.025em;
    }

    .report-title {
      font-size: 2.25rem;
      font-weight: 800;
      margin-bottom: 0.5rem;
      letter-spacing: -0.05em;
    }

    .report-subtitle {
      font-size: 1.125rem;
      color: rgba(255,255,255,0.8);
      margin-bottom: 1.5rem;
    }

    .report-meta {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      font-size: 0.875rem;
    }

    .meta-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: rgba(255,255,255,0.9);
    }

    /* Content Section */
    .content {
      padding: 2.5rem;
    }

    .section {
      margin-bottom: 2.5rem;
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
      padding-bottom: 0.75rem;
      border-bottom: 2px solid #e5e7eb;
    }

    .section-icon {
      width: 32px;
      height: 32px;
      background: #f3f4f6;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #6b7280;
    }

    .section-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: #1f2937;
      letter-spacing: -0.025em;
    }

    /* Employee Info */
    .employee-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
      margin-bottom: 2rem;
    }

    .info-card {
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 1.5rem;
    }

    .info-row {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 0.75rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid #e5e7eb;
    }

    .info-row:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }

    .info-label {
      font-weight: 600;
      color: #6b7280;
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .info-value {
      font-weight: 500;
      color: #1f2937;
      text-align: right;
      max-width: 60%;
    }

    /* Summary Stats */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2.5rem;
    }

    .stat-card {
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
      color: white;
      padding: 1.5rem;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }

    .stat-number {
      font-size: 2rem;
      font-weight: 800;
      display: block;
      margin-bottom: 0.25rem;
    }

    .stat-label {
      font-size: 0.875rem;
      opacity: 0.9;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Assets Table */
    .assets-table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
    }

    .assets-table thead {
      background: #f9fafb;
    }

    .assets-table th {
      padding: 1rem 0.75rem;
      text-align: left;
      font-weight: 600;
      color: #374151;
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      border-bottom: 2px solid #e5e7eb;
    }

    .assets-table td {
      padding: 1rem 0.75rem;
      border-bottom: 1px solid #e5e7eb;
      font-size: 0.875rem;
    }

    .assets-table tbody tr:hover {
      background: #f9fafb;
    }

    .assets-table tbody tr:last-child td {
      border-bottom: none;
    }

    .asset-id {
      font-family: 'JetBrains Mono', 'Fira Code', monospace;
      background: #f3f4f6;
      padding: 0.25rem 0.5rem;
      border-radius: 6px;
      font-size: 0.8rem;
      font-weight: 600;
      color: #1f2937;
    }

    .asset-name {
      font-weight: 600;
      color: #1f2937;
    }

    .asset-status {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .status-assigned {
      background: #dcfce7;
      color: #166534;
    }

    .status-available {
      background: #dbeafe;
      color: #1e40af;
    }

    .no-assets {
      text-align: center;
      padding: 3rem;
      color: #6b7280;
    }

    .no-assets-icon {
      font-size: 4rem;
      color: #d1d5db;
      margin-bottom: 1rem;
    }

    /* Footer */
    .footer {
      margin-top: auto;
      padding: 1.5rem 2.5rem;
      background: #f9fafb;
      border-top: 1px solid #e5e7eb;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.875rem;
      color: #6b7280;
    }

    .footer-left {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .footer-right {
      font-weight: 500;
    }

    /* Print Styles */
    @media print {
      .report-container {
        max-width: none;
        margin: 0;
        box-shadow: none;
      }

      body {
        background: white;
      }

      .assets-table {
        box-shadow: none;
      }

      .stat-card {
        box-shadow: none;
      }
    }

    @page {
      size: A4;
      margin: 0;
    }
  </style>
</head>
<body>
  <div class="report-container">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="company-logo">
          <div class="logo-icon">üìã</div>
          <div class="company-name">Asset Management System</div>
        </div>

        <h1 class="report-title">Asset Assignment Report</h1>
        <p class="report-subtitle">Comprehensive asset overview for <%= employee.name %></p>

        <div class="report-meta">
          <div class="meta-item">
            <span>üìÖ</span>
            <span>Generated: <%= new Date().toLocaleDateString('en-US', {
              year: 'numeric',
              month: 'long',
              day: 'numeric',
              hour: '2-digit',
              minute: '2-digit'
            }) %></span>
          </div>
          <div class="meta-item">
            <span>üë§</span>
            <span>Employee ID: <%= employee.cep %></span>
          </div>
          <div class="meta-item">
            <span>üè¢</span>
            <span>Department: <%= employee.department_name || 'N/A' %></span>
          </div>
          <div class="meta-item">
            <span>üìÑ</span>
            <span>Report ID: RPT-<%= new Date().getFullYear() %>-<%= String(new Date().getMonth() + 1).padStart(2, '0') %><%= String(new Date().getDate()).padStart(2, '0') %>-<%= employee.cep %></span>
          </div>
        </div>
      </div>
    </header>

    <!-- Content -->
    <main class="content">
      <!-- Employee Information Section -->
      <section class="section">
        <div class="section-header">
          <div class="section-icon">üë§</div>
          <h2 class="section-title">Employee Information</h2>
        </div>

        <div class="employee-grid">
          <div class="info-card">
            <div class="info-row">
              <span class="info-label">Full Name</span>
              <span class="info-value"><%= employee.name %></span>
            </div>
            <div class="info-row">
              <span class="info-label">Employee ID</span>
              <span class="info-value"><%= employee.cep %></span>
            </div>
            <div class="info-row">
              <span class="info-label">Email Address</span>
              <span class="info-value"><%= employee.email || 'N/A' %></span>
            </div>
            <div class="info-row">
              <span class="info-label">Job Title</span>
              <span class="info-value"><%= employee.job_title || 'N/A' %></span>
            </div>
          </div>

          <div class="info-card">
            <div class="info-row">
              <span class="info-label">Department</span>
              <span class="info-value"><%= employee.department_name || 'N/A' %></span>
            </div>
            <div class="info-row">
              <span class="info-label">Location</span>
              <span class="info-value"><%= employee.location_name || 'N/A' %></span>
            </div>
            <div class="info-row">
              <span class="info-label">Start Date</span>
              <span class="info-value"><%= employee.joined_date ? new Date(employee.joined_date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) : 'N/A' %></span>
            </div>
            <div class="info-row">
              <span class="info-label">Status</span>
              <span class="info-value">
                <% if (employee.left_date) { %>
                  Former Employee
                <% } else { %>
                  Active
                <% } %>
              </span>
            </div>
          </div>
        </div>
      </section>

      <!-- Summary Statistics -->
      <section class="section">
        <div class="section-header">
          <div class="section-icon">üìä</div>
          <h2 class="section-title">Assignment Summary</h2>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <span class="stat-number"><%= stats.total_items || 0 %></span>
            <span class="stat-label">Total Assets</span>
          </div>

          <div class="stat-card" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
            <span class="stat-number"><%= stats.asset_types || 0 %></span>
            <span class="stat-label">Asset Types</span>
          </div>

          <div class="stat-card" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
            <span class="stat-number">
              <%= items && items.filter(i => i.date_assigned && new Date(i.date_assigned) > new Date(Date.now() - 30*24*60*60*1000)).length || 0 %>
            </span>
            <span class="stat-label">Recent Assignments</span>
          </div>

          <div class="stat-card" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">
            <span class="stat-number">
              <%= items && items.filter(i => i.warranty_end_date && new Date(i.warranty_end_date) > new Date()).length || 0 %>
            </span>
            <span class="stat-label">Under Warranty</span>
          </div>
        </div>
      </section>

      <!-- Assigned Assets Section -->
      <section class="section">
        <div class="section-header">
          <div class="section-icon">üíª</div>
          <h2 class="section-title">Assigned Assets</h2>
        </div>

        <% if (items && items.length > 0) { %>
          <table class="assets-table">
            <thead>
              <tr>
                <th>CEXID</th>
                <th>Asset Name</th>
                <th>Type</th>
                <th>Brand & Model</th>
                <th>Serial Number</th>
                <th>Date Assigned</th>
                <th>Location</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody>
              <% items.forEach(item => { %>
                <tr>
                  <td>
                    <span class="asset-id"><%= item.cep_brc %></span>
                  </td>
                  <td>
                    <span class="asset-name"><%= item.name %></span>
                  </td>
                  <td><%= item.type_name || 'N/A' %></td>
                  <td>
                    <%= item.brand_name || 'N/A' %>
                    <% if (item.model) { %>
                      <br><small style="color: #6b7280;"><%= item.model %></small>
                    <% } %>
                  </td>
                  <td>
                    <% if (item.serial_cod) { %>
                      <span style="font-family: monospace; font-size: 0.8rem; background: #f3f4f6; padding: 2px 4px; border-radius: 4px;"><%= item.serial_cod %></span>
                    <% } else { %>
                      N/A
                    <% } %>
                  </td>
                  <td>
                    <%= item.date_assigned ? new Date(item.date_assigned).toLocaleDateString('en-US', {
                      year: 'numeric',
                      month: 'short',
                      day: 'numeric'
                    }) : 'N/A' %>
                  </td>
                  <td>
                    <%= item.location_name || employee.location_name || 'N/A' %>
                  </td>
                  <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                    <%= item.notes || item.assignment_notes || '' %>
                  </td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        <% } else { %>
          <div class="no-assets">
            <div class="no-assets-icon">üì¶</div>
            <h3 style="margin-bottom: 0.5rem; color: #374151;">No Assets Assigned</h3>
            <p>This employee currently has no assets assigned to them.</p>
          </div>
        <% } %>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-left">
        <span>üè¢</span>
        <span>Generated by Asset Management System</span>
      </div>
      <div class="footer-right">
        Confidential Document - Page 1 of 1
      </div>
    </footer>
  </div>
</body>
</html>
