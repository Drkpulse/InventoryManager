<div class="container mx-auto px-4 py-8">
  <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8">
    <div>
      <h1 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-2 flex items-center gap-2">
        <i class="fas fa-plus"></i> Add New Software
      </h1>
    </div>
    <div class="flex flex-wrap gap-2 mt-4 md:mt-0">
      <a href="/software" class="inline-flex items-center px-4 py-2 bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-100 font-semibold rounded-md transition">
        <i class="fas fa-arrow-left mr-2"></i> Back to Software
      </a>
    </div>
  </div>

  <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-8 max-w-2xl mx-auto">
    <form method="POST" action="/software" class="space-y-10">
      <!-- Software Identification Section -->
      <div>
        <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4 flex items-center gap-2">
          <i class="fas fa-laptop-code"></i> Software Details
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="col-span-1 md:col-span-2">
            <label for="name" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200">Software Name <span class="text-red-500">*</span></label>
            <input type="text" id="name" name="name" required
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
              placeholder="e.g., Microsoft Office, LibreOffice, Google Workspace">
            <small class="text-gray-500 dark:text-gray-400">Enter the software name</small>
          </div>
          <div>
            <label for="version" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200">Version</label>
            <input type="text" id="version" name="version"
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
              placeholder="e.g., 2021, 7.2.5">
          </div>
          <div>
            <label for="license_type" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200">License Type</label>
            <select id="license_type" name="license_type"
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
              <option value="">-- Select License Type --</option>
              <% if (typeof licenseTypes !== 'undefined' && licenseTypes.length) { %>
                <% licenseTypes.forEach(type => { %>
                  <option value="<%= type %>"><%= type %></option>
                <% }) %>
              <% } %>
              <option value="__other__">Other...</option>
            </select>
            <input type="text" id="license_type_other" name="license_type_other" style="display:none;"
              class="mt-2 w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
              placeholder="Enter license type">
          </div>
          <div class="col-span-1 md:col-span-2">
            <label for="description" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200">Description</label>
            <textarea id="description" name="description" rows="3"
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition resize-vertical"
              placeholder="Enter a description (optional)"></textarea>
            <small class="text-gray-500 dark:text-gray-400 flex items-center gap-1 mt-1">
              <i class="fas fa-info-circle"></i>
              Provide additional details about the software (optional)
            </small>
          </div>
        </div>
      </div>

      <!-- License & Purchase Section -->
      <div>
        <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4 flex items-center gap-2">
          <i class="fas fa-certificate"></i> License & Purchase
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label for="max_licenses" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200">Max Licenses</label>
            <input type="number" id="max_licenses" name="max_licenses" min="1"
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
              placeholder="e.g., 10">
            <small class="text-gray-500 dark:text-gray-400">Total number of licenses purchased</small>
          </div>
          <div>
            <label for="cost_per_license" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200">Cost per License (€)</label>
            <div class="flex">
              <span class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 dark:border-gray-700 bg-gray-100 dark:bg-gray-900 text-gray-600 dark:text-gray-400">€</span>
              <input type="number" id="cost_per_license" name="cost_per_license" step="0.01" min="0"
                class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-r-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
                placeholder="0.00">
            </div>
            <small class="text-gray-500 dark:text-gray-400">Cost in euros per license (optional)</small>
          </div>
          <div>
            <label for="vendor" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200">Vendor</label>
            <select id="vendor" name="vendor"
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
              <option value="">-- Select Vendor --</option>
              <% if (typeof vendors !== 'undefined' && vendors.length) { %>
                <% vendors.forEach(vendor => { %>
                  <option value="<%= vendor %>"><%= vendor %></option>
                <% }) %>
              <% } %>
              <option value="__other__">Other...</option>
            </select>
            <input type="text" id="vendor_other" name="vendor_other" style="display:none;"
              class="mt-2 w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
              placeholder="Enter vendor">
          </div>
          <div>
            <label for="purchase_date" class="block font-semibold mb-1 text-gray-700 dark:text-gray-200">Purchase Date</label>
            <input type="date" id="purchase_date" name="purchase_date"
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
            <small class="text-gray-500 dark:text-gray-400">Date of purchase (optional)</small>
          </div>
        </div>
      </div>
      <!-- Form Actions -->
      <div class="flex flex-wrap gap-2 mt-8">
        <button type="submit" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-md transition flex items-center gap-2">
          <i class="fas fa-plus"></i> Add Software
        </button>
        <a href="/software" class="px-6 py-2 bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-100 font-semibold rounded-md transition flex items-center gap-2">
          <i class="fas fa-times"></i> Cancel
        </a>
      </div>
    </form>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  function handleOther(selectId, inputId) {
    const select = document.getElementById(selectId);
    const input = document.getElementById(inputId);
    if (!select || !input) return;
    select.addEventListener('change', function() {
      if (this.value === '__other__') {
        input.style.display = '';
        input.required = true;
      } else {
        input.style.display = 'none';
        input.required = false;
      }
    });
  }
  handleOther('license_type', 'license_type_other');
  handleOther('vendor', 'vendor_other');
});
</script>
